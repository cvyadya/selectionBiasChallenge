---
title: "Selection Bias & Missing Data Challenge"
subtitle: "Creating a Statistics Meme"
format:
  html: default
execute:
  echo: true
  eval: true
---

# ðŸŽ¨ Selection Bias & Missing Data Challenge

```{python}
#| label: final-meme
#| echo: false
#| eval: true
#| fig-cap: "Statistics meme demonstrating selection bias"

# Display the final meme
import matplotlib.pyplot as plt
import matplotlib.image as mpimg
from step1_prepare_image import prepare_image
from step2_create_stipple import create_stipple
from step3_create_tonal import create_tonal
from step4_create_block_letter import create_block_letter_s
from step5_create_masked import create_masked_stipple
from create_meme import create_statistics_meme

# Load and prepare the image
# CHANGE THIS to use your own image!
img_path = 'Capture.JPG'  # Example image - replace with your own image
gray_image = prepare_image(img_path, max_size=512)

# Create stippled image
stipple_pattern, samples = create_stipple(
    gray_image,
    percentage=0.07,  # 8% of pixels will be stippled
    sigma=0.9,  # Repulsion radius
    content_bias=0.9,  # Strongly follow importance map
    noise_scale_factor=0.1,  # Moderate exploration
    extreme_downweight=0.5,  # Moderate downweighting of extremes 
    extreme_threshold_low=0.2,  # Downweight tones below 0.2
    extreme_threshold_high=0.9,  # Downweight tones above 0.8
    extreme_sigma=0.3 # Smooth transition width
)

# Get image dimensions
h, w = gray_image.shape

# Create block letter S
block_letter = create_block_letter_s(h, w, letter="S", font_size_ratio=0.9)


# Create masked stippled image
masked_stipple = create_masked_stipple(
    stipple_pattern,
    block_letter,
    threshold=0.5  # Pixels below 0.5 are considered part of the mask
)

# Create the final meme
create_statistics_meme(
    original_img=gray_image,
    stipple_img=stipple_pattern,
    block_letter_img=block_letter,
    masked_stipple_img=masked_stipple,
    output_path="my_statistics_meme.png",
    dpi=150,
    background_color="white"  # or "pink", "lightgray", etc.
)

# Load and display the meme image
meme_img = mpimg.imread("my_statistics_meme.png")
fig, ax = plt.subplots(figsize=(8, 6))
ax.imshow(meme_img)
ax.axis('off')
plt.tight_layout()
plt.show()
```


As seen here in the image, the selection bias is represented by the letter "S". The original image (Reality) represents the true population in this case an image of a elephant, while the stippled version shows our sampling and data collection. When selection bias is applied to the stippled image, data points are removed in a systematic "S" pattern, the resulting estimate becomes biased and no longer represents the true image, just as missing data in real-world studies can lead to incorrect conclusions.
